<!doctype html>
<html lang="zh-Hans" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.2.0">
<title data-rh="true">基于 Mybatis Plus 的数据持久化 API 总结 | 程序员大熊的博客网站®</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://pulanos.gitee.io/blog/blog/mybatis-plus-data-persistance-summary"><meta data-rh="true" name="docusaurus_locale" content="zh-Hans"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="zh-Hans"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" name="author" content="程序员大熊 熊春"><meta data-rh="true" name="keywords" content="盘古开发框架 熊春 盘古通用权限系统 开源中后台业务脚手架 pangu-admin  分布式微服务架构 垂直单体分层架构 普蓝开源社区"><meta data-rh="true" name="baidu-site-verification" content="code-umYMvMmkhO"><meta data-rh="true" property="og:title" content="基于 Mybatis Plus 的数据持久化 API 总结 | 程序员大熊的博客网站®"><meta data-rh="true" name="description" content="盘古开发框架 数据持久化 API 依赖 MyBatis Plus 提供。在 MyBatis 的基础上提供了强大的内置通用 Mapper CRUD 操作、支持 Lambda 表达式、内置屏蔽不通数据库方言差异的分页插件、自动填充字段值、多种主键自动生成策略、逻辑删除、乐观锁插件等。"><meta data-rh="true" property="og:description" content="盘古开发框架 数据持久化 API 依赖 MyBatis Plus 提供。在 MyBatis 的基础上提供了强大的内置通用 Mapper CRUD 操作、支持 Lambda 表达式、内置屏蔽不通数据库方言差异的分页插件、自动填充字段值、多种主键自动生成策略、逻辑删除、乐观锁插件等。"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2018-07-15T00:00:00.000Z"><meta data-rh="true" property="article:author" content="https://gitee.com/xiong-chun"><meta data-rh="true" property="article:tag" content="服务端开发,盘古开发框架,数据持久化"><link data-rh="true" rel="icon" href="/blog/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://pulanos.gitee.io/blog/blog/mybatis-plus-data-persistance-summary"><link data-rh="true" rel="alternate" href="https://pulanos.gitee.io/blog/blog/mybatis-plus-data-persistance-summary" hreflang="zh-Hans"><link data-rh="true" rel="alternate" href="https://pulanos.gitee.io/blog/blog/mybatis-plus-data-persistance-summary" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/blog/rss.xml" title="程序员大熊的博客网站® RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/blog/atom.xml" title="程序员大熊的博客网站® Atom Feed">





<script src="https://hm.baidu.com/hm.js?a3851aa1c0b2c77a661cda32561aad26" async></script><link rel="stylesheet" href="/blog/assets/css/styles.3be9e9e4.css">
<link rel="preload" href="/blog/assets/js/runtime~main.6306fde2.js" as="script">
<link rel="preload" href="/blog/assets/js/main.9ab7ca0e.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="跳到主要内容"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">跳到主要内容</a></div><nav class="navbar navbar--fixed-top navbarHideable_m1mJ"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/blog/"><div class="navbar__logo"><img src="/blog/img/logo.svg" alt="程序员大熊博客网站" class="themedImage_ToTc themedImage--light_HNdA"><img src="/blog/img/logo.svg" alt="程序员大熊博客网站" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">程序员大熊博客®</b></a></div><div class="navbar__items navbar__items--right"><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog/blog/">文章</a><a class="navbar__item navbar__link" href="/blog/blog/archive/">归档</a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">开源作品</a><ul class="dropdown__menu"><li><a href="https://pulanos.gitee.io/pangu-framework" target="_blank" rel="noopener noreferrer" class="dropdown__link">盘古开发框架</a></li><li><a class="dropdown__link" href="/blog/blog/aosuite-eol/">AOSuite 开发平台 [EOL]</a></li></ul></div><a class="navbar__item navbar__link" href="/blog/about">关于</a><a href="https://gitee.com/xiong-chun" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-gitee-link"></a><a href="https://gitee.com/xiong-chun" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="切换浅色/暗黑模式（当前为浅色模式）" aria-label="切换浅色/暗黑模式（当前为浅色模式）" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><div class="navbar__search searchBarContainer_NW3z"><input placeholder="搜索" aria-label="Search" class="navbar__search-input"><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><main class="col col--9 col--offset-1" itemscope="" itemtype="http://schema.org/Blog"><article itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h1 class="title_f1Hy" itemprop="headline">基于 Mybatis Plus 的数据持久化 API 总结</h1><div class="container_mt6G margin-vert--md"><time datetime="2018-07-15T00:00:00.000Z" itemprop="datePublished">2018年7月15日</time> · <!-- -->阅读需 9 分钟</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://gitee.com/xiong-chun" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://xiongchun.pulanit.com/img/xiongchun.jpg" alt="程序员大熊"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://gitee.com/xiong-chun" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">程序员大熊</span></a></div><small class="avatar__subtitle" itemprop="description">Pangu Framework maintainer</small></div></div></div></div></header><div id="post-content" class="markdown" itemprop="articleBody"><p><a href="https://pulanos.gitee.io/pangu-framework" target="_blank" rel="noopener noreferrer">盘古开发框架</a> 数据持久化 API 依赖 MyBatis Plus 提供。在 MyBatis 的基础上提供了强大的内置通用 Mapper CRUD 操作、支持 Lambda 表达式、内置屏蔽不通数据库方言差异的分页插件、自动填充字段值、多种主键自动生成策略、逻辑删除、乐观锁插件等。</p><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary><b>快速 QA：</b>可以支持兼容哪些数据库类型？</summary><div><div class="collapsibleContent_i85q"><div>与 MyBatis Plus 一致。支持所有 JDBC 标准数据库。分页方言兼容如下数据库： mysql、oracle、db2、h2、hsql、sqlite、postgresql、sqlserver、phoenix、gauss、clickhouse、sybase、oceanbase、firebird、cubrid、goldilocks、csiidb、达梦数据库、虚谷数据库、人大金仓数据库、南大通用(华库)数据库、南大通用数据库、神通数据库、瀚高数据库。</div></div></div></details><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="安装相关盘古模块">安装相关盘古模块<a class="hash-link" href="#安装相关盘古模块" title="标题的直接链接">​</a></h2><div class="tabs-container tabList__CuJ"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LNqP tabs__item--active">盘古 Parent</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">基础模块</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">JDBC 模块</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Ymn6"><div class="language-jsx codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-jsx codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">parent</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text">com.gitee.pulanos.pangu</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text">pangu-parent</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text">latest.version.xxx</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">relativePath</span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><span class="token plain-text"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">parent</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><div class="language-jsx codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-jsx codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text">com.gitee.pulanos.pangu</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text">pangu-spring-boot-starter</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><div class="language-jsx codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-jsx codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text">com.gitee.pulanos.pangu</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text">pangu-framework-jdbc-spring-boot-starter</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="本地配置">本地配置<a class="hash-link" href="#本地配置" title="标题的直接链接">​</a></h2><blockquote><p>为便于理解，本文基于本地配置的方式编写。若改为标准的Nacos配置中心模式，请参阅:<a href="https://pulanos.gitee.io/pangu-framework/docs/advanced-guide/nacos-config-center" target="_blank" rel="noopener noreferrer">配置中心</a>章节。</p></blockquote><div class="tabs-container tabList__CuJ"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">application.properties</li><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LNqP tabs__item--active">application-dev.properties</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Ymn6" hidden=""><div class="language-jsx codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-jsx codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">spring</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">profiles</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">active</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">$</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">spring</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">profiles</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">active</span><span class="token operator" style="color:#393A34">:</span><span class="token plain">dev</span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><div role="tabpanel" class="tabItem_Ymn6"><div class="language-jsx codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-jsx codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">spring</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">application</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">name</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">pangu</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">examples</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">crud</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spring</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">datasource</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">type</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">com</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">zaxxer</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">hikari</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access maybe-class-name">HikariDataSource</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spring</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">datasource</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">driver</span><span class="token operator" style="color:#393A34">-</span><span class="token keyword" style="color:#00009f">class</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">name</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">com</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">mysql</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">cj</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">jdbc</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access maybe-class-name">Driver</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spring</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">datasource</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">url</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">jdbc</span><span class="token operator" style="color:#393A34">:</span><span class="token plain">mysql</span><span class="token operator" style="color:#393A34">:</span><span class="token operator" style="color:#393A34">/</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">localhost</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">3306</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">pangu</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">examples</span><span class="token operator" style="color:#393A34">?</span><span class="token plain">useUnicode</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">true</span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">characterEncoding</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">utf</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">8</span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">autoReconnect</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">true</span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">failOverReadOnly</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">false</span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">allowMultiQueries</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">true</span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">useSSL</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">false</span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">rewriteBatchedStatements</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spring</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">datasource</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">username</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">root</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spring</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">datasource</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">password</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">root123456</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mybatis</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">plus</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">mapperLocations</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">classpath</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">:</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">mapper</span><span class="token comment" style="color:#999988;font-style:italic">/**/</span><span class="token operator" style="color:#393A34">*</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">xml</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mybatis</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">plus</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">configuration</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">log</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">impl</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">org</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">apache</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">ibatis</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">logging</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">slf4j</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access maybe-class-name">Slf4jImpl</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 分页</span><span class="token constant" style="color:#36acaa">SQL</span><span class="token plain">方言数据库类型标识（缺省：自动识别）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pangu</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">jdbc</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">db</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">type</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">mysql</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">logging</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">level</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">root</span><span class="token operator" style="color:#393A34">=</span><span class="token constant" style="color:#36acaa">INFO</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">logging</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">level</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">com</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">gitee</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">pulanos</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">pangu</span><span class="token operator" style="color:#393A34">=</span><span class="token constant" style="color:#36acaa">INFO</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">logging</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">level</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">com</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">gitee</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">pulanos</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">pangu</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">showcases</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">crud</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">dao</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">debug</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="生成持久化所需的模版代码">生成持久化所需的模版代码<a class="hash-link" href="#生成持久化所需的模版代码" title="标题的直接链接">​</a></h2><p>基于实践经验，我们建议使用盘古代码生成器，而不是使用 Mybatis Plus 官方生成器。关于生成代码相关内容，请参阅 <a href="https://pulanos.gitee.io/pangu-framework/docs/code-generator" target="_blank" rel="noopener noreferrer">《代码生成器插件》</a> 章节，这里不再赘述。（针对每一个数据表会生成一个 <code>*Mapper.java</code> 文件和一个 <code>*Entity.java</code> 文件）</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="基本数据持久化操作">基本数据持久化操作<a class="hash-link" href="#基本数据持久化操作" title="标题的直接链接">​</a></h2><blockquote><p>这里只是给出几个简单典型的操作代码，更多内容请参阅范例或阅读 <a href="https://baomidou.com/pages/24112f/" target="_blank" rel="noopener noreferrer">Mybatis Plus 官方文档</a>。</p></blockquote><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="新增">新增<a class="hash-link" href="#新增" title="标题的直接链接">​</a></h3><div class="language-jsx codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-jsx codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token maybe-class-name">UserEntity</span><span class="token plain"> userEntity </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">UserEntity</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">userEntity</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">setName</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;XC&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">setAge</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">18</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">setUserType</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;1&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">int row </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> userMapper</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">insert</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">userEntity</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">log</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">info</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;成功插入{}条数据。{}&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> row</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> userEntity</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="修改">修改<a class="hash-link" href="#修改" title="标题的直接链接">​</a></h3><div class="language-jsx codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-jsx codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">//方式1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">userMapper</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">updateById</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">UserEntity</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">setId</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">1L</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">setName</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;XC2&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">//方式2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token maybe-class-name">LambdaUpdateWrapper</span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag class-name" style="color:#00009f">UserEntity</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"> updateWrapper = Wrappers.lambdaUpdate();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text">updateWrapper.set(UserEntity::getAge, 100);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text">updateWrapper.eq(UserEntity::getId, 2L);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text">userMapper.update(null, updateWrapper);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text">//方式2简写</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text">userMapper.update(null, Wrappers.</span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag class-name" style="color:#00009f">UserEntity</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text">lambdaUpdate().set(UserEntity::getName, &quot;XC2&quot;).eq(UserEntity::getId, 3L));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text">//方式3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text">UserEntity userEntity = new UserEntity();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text">userEntity.setName(&quot;XC2&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text">userMapper.update(userEntity, Wrappers.</span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag class-name" style="color:#00009f">UserEntity</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text">lambdaUpdate().eq(UserEntity::getId, 4L));</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="删除">删除<a class="hash-link" href="#删除" title="标题的直接链接">​</a></h3><div class="language-jsx codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-jsx codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">//方式1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">userMapper</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">deleteById</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">1000L</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">//方式2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">userMapper</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">deleteBatchIds</span><span class="token punctuation" style="color:#393A34">(</span><span class="token maybe-class-name">Arrays</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">asList</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">1000L</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> 1001L</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">//方式3</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">userMapper</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">delete</span><span class="token punctuation" style="color:#393A34">(</span><span class="token maybe-class-name">Wrappers</span><span class="token punctuation" style="color:#393A34">.</span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag class-name" style="color:#00009f">UserEntity</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text">lambdaQuery().ge(UserEntity::getAge, 150));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text">userMapper.delete(Wrappers.lambdaQuery(UserEntity.class).ge(UserEntity::getAge, 150));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text">//方式4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text">userMapper.deleteById(new UserEntity().setId(2000L));</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="简单查询">简单查询<a class="hash-link" href="#简单查询" title="标题的直接链接">​</a></h3><div class="language-jsx codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-jsx codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">//方式1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token maybe-class-name">UserEntity</span><span class="token plain"> userEntity </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> userMapper</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">selectById</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">1L</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">//方式2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token maybe-class-name">UserEntity</span><span class="token plain"> userEntity1 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> userMapper</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">selectOne</span><span class="token punctuation" style="color:#393A34">(</span><span class="token maybe-class-name">Wrappers</span><span class="token punctuation" style="color:#393A34">.</span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag class-name" style="color:#00009f">UserEntity</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text">lambdaQuery().eq(UserEntity::getId, 1L));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text">//方式3 (需要注意对传入 ID 集合为非空判断，否则生成的 SQL in() 语法将报错)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text">if(CollUtil.isNotEmpty(userIds))</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    userEntities </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> userMapper</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">selectBatchIds</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">userIds</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain-text"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text">//方式4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text">LambdaQueryWrapper</span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag class-name" style="color:#00009f">UserEntity</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"> lambdaQueryWrapper = Wrappers.lambdaQuery();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text">//动态组合查询条件的简便写法</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text">lambdaQueryWrapper.between(ObjectUtil.isNotEmpty(age), UserEntity::getAge, 1, age);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text">lambdaQueryWrapper.eq(UserEntity::getUserType, &quot;1&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text">lambdaQueryWrapper.orderByDesc(UserEntity::getId);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text">List</span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag class-name" style="color:#00009f">UserEntity</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"> userEntities1 = userMapper.selectList(lambdaQueryWrapper);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text">//方式5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text">LambdaQueryWrapper</span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag class-name" style="color:#00009f">UserRoleEntity</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"> lambdaQueryWrapper = Wrappers.lambdaQuery();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text">lambdaQueryWrapper.eq(UserRoleEntity::getUserId, userId).orderByDesc(UserRoleEntity::getRoleId);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text">List</span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag class-name" style="color:#00009f">UserRoleEntity</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"> userRoleEntities = userRoleMapper.selectList(lambdaQueryWrapper);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text">List</span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag class-name" style="color:#00009f">Long</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"> roleIds = userRoleEntities.stream().map(UserRoleEntity::getRoleId).collect(Collectors.toList());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text">//方式6</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text">List&lt;Map&lt;String, Object&gt;&gt; userMaps = userMapper.selectMaps(Wrappers.</span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag class-name" style="color:#00009f">UserEntity</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text">lambdaQuery().eq(UserEntity::getUserType, &quot;1&quot;));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text">//方式7 count 查询</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text">Long cnt = userMapper.selectCount(Wrappers.</span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag class-name" style="color:#00009f">UserEntity</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text">lambdaQuery().le(UserEntity::getGmtCreate, DateUtil.date()));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text">//方式8 group 查询</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text">QueryWrapper</span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag class-name" style="color:#00009f">UserEntity</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"> queryWrapper1 = Wrappers.query();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text">queryWrapper1.select(&quot;age, count(id) as cnt&quot;).groupBy(&quot;age&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text">List&lt;Map&lt;String, Object&gt;&gt; mapList = userMapper.selectMaps(queryWrapper1);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text">//方式9 or 查询</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text">if (ObjectUtil.isNotEmpty(keyword))</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    lambdaQueryWrapper</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">and</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">w </span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> w</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">like</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"> </span><span class="token maybe-class-name">UserEntity</span><span class="token operator" style="color:#393A34">:</span><span class="token operator" style="color:#393A34">:</span><span class="token plain">getName</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> keyword</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">or</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">like</span><span class="token punctuation" style="color:#393A34">(</span><span class="token maybe-class-name">UserEntity</span><span class="token operator" style="color:#393A34">:</span><span class="token operator" style="color:#393A34">:</span><span class="token plain">getUserName</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> keyword</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain-text"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text">//方式10 指定查询字段</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text">LambdaQueryWrapper</span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag class-name" style="color:#00009f">UserEntity</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"> lambdaQueryWrapper = Wrappers.lambdaQuery();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text">lambdaQueryWrapper.select(UserEntity::getId, UserEntity::getUserName);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text">lambdaQueryWrapper.eq(...);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text">//方式11 排除查询字段</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text">lambdaQueryWrapper.select(UserEntity.class, info -&gt; !info.getColumn().equals(&quot;password&quot;) &amp;&amp; !info.getColumn().equals(&quot;password2&quot;));</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="分页查询">分页查询<a class="hash-link" href="#分页查询" title="标题的直接链接">​</a></h3><p>盘古框架已经做了 Mybatis Plus 分页插件的自动装配工作，直接使用即可。无需额外配置。</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="基于-mapper-api-的分页查询">基于 Mapper API 的分页查询<a class="hash-link" href="#基于-mapper-api-的分页查询" title="标题的直接链接">​</a></h4><div class="language-jsx codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-jsx codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">aPageQuery</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    log</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">info</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;MyBatisPlus API 分页查询数据...&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token maybe-class-name">Page</span><span class="token plain"> page </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">Page</span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag class-name" style="color:#00009f">UserEntity</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text">(1,3);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text">    userMapper.selectPage(page, Wrappers.</span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag class-name" style="color:#00009f">UserEntity</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text">lambdaQuery().ge(UserEntity::getAge, 10).orderByAsc(UserEntity::getId));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text">    Console.log(&quot;总数：{}&quot;, page.getTotal());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text">    List</span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag class-name" style="color:#00009f">UserEntity</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"> userEntities = page.getRecords();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text">    userEntities.forEach(System.out::println);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="基于手工映射-sql-的分页查询">基于手工映射 SQL 的分页查询<a class="hash-link" href="#基于手工映射-sql-的分页查询" title="标题的直接链接">​</a></h4><p>继续阅读本文后面的 <a href="#%E6%89%8B%E5%B7%A5%E7%BC%96%E5%86%99sql%E6%98%A0%E5%B0%84">《手工编写SQL映射》</a> 章节可以找到。</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="一个完整的分页查询例子">一个完整的分页查询例子<a class="hash-link" href="#一个完整的分页查询例子" title="标题的直接链接">​</a></h4><div class="language-jsx codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-jsx codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// 分页入参对象</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">RoleIn</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">extends</span><span class="token plain"> </span><span class="token class-name">Page</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">private</span><span class="token plain"> </span><span class="token known-class-name class-name">String</span><span class="token plain"> name</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// Controller</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@</span><span class="token function maybe-class-name" style="color:#d73a49">GetMapping</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;/list&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token maybe-class-name">Result</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token maybe-class-name">PageResult</span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag class-name" style="color:#00009f">RoleEntity</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text">&gt; list(RoleIn roleIn) </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token maybe-class-name">PageResult</span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag class-name" style="color:#00009f">RoleEntity</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"> pageResult = roleService.list(roleIn);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text">    return Result.success(pageResult);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text">// Service实现</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text">public PageResult</span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag class-name" style="color:#00009f">RoleEntity</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"> list(RoleIn roleIn) </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token maybe-class-name">Page</span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag class-name" style="color:#00009f">RoleEntity</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"> page = PagingUtil.createPage(roleIn);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text">    LambdaQueryWrapper</span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag class-name" style="color:#00009f">RoleEntity</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"> lambdaQueryWrapper = Wrappers.lambdaQuery();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text">    lambdaQueryWrapper.like(ObjectUtil.isNotEmpty(roleIn.getName()), RoleEntity::getName, roleIn.getName());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text">    roleMapper.selectPage(page, lambdaQueryWrapper);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text">    return PagingUtil.getPageResult(page);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="手工编写sql映射">手工编写SQL映射<a class="hash-link" href="#手工编写sql映射" title="标题的直接链接">​</a></h3><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>提示</div><div class="admonitionContent_S0QG"><p>一般来说在日常开发中我们是不需要再编写SQL代码的，Mapper API已经能满足我们的需求了。但对于一些特殊需求，我们也可以手工写SQL映射的方式来处理。如下范例演示了手工SQL查询的操作，新增、修改、删除也是同理。</p></div></div><div class="language-jsx codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-jsx codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">bPageQuery</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    log</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">info</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;自定义SQL映射分页查询数据...&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token maybe-class-name">Page</span><span class="token plain"> page </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">Page</span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag class-name" style="color:#00009f">UserEntity</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text">(1,3);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text">    Map&lt;String, Object&gt; params = Maps.newHashMap();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text">    params.put(&quot;userType&quot;, &quot;1&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text">    List</span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag class-name" style="color:#00009f">UserEntity</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"> userEntities = crudMapper.listUsersByPage(page, params);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text">    Console.log(&quot;总数：{}&quot;, page.getTotal());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text">    userEntities.forEach(System.out::println);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text">public void cPageQuery()</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    log</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">info</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;自定义SQL映射分页查询数据...&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token maybe-class-name">Page</span><span class="token plain"> page </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">Page</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token known-class-name class-name">Map</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token known-class-name class-name">String</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token known-class-name class-name">Object</span><span class="token operator" style="color:#393A34">&gt;&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token known-class-name class-name">String</span><span class="token plain"> userType </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;1&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token maybe-class-name">List</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token known-class-name class-name">Map</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token known-class-name class-name">String</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token known-class-name class-name">Object</span><span class="token operator" style="color:#393A34">&gt;&gt;</span><span class="token plain"> userMaps </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> crudMapper</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">listUserMapsByPage</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">page</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> userType</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token maybe-class-name">Console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;总数：{}&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> page</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">getTotal</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    userMaps</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">forEach</span><span class="token punctuation" style="color:#393A34">(</span><span class="token maybe-class-name">System</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">out</span><span class="token operator" style="color:#393A34">:</span><span class="token operator" style="color:#393A34">:</span><span class="token plain">println</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain-text"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text">public void bSelect() </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    log</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">info</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;自定义SQL映射查询数据...&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token known-class-name class-name">Map</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token known-class-name class-name">String</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token known-class-name class-name">Object</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> params </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token maybe-class-name">Maps</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">newHashMap</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    params</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">put</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;userType&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;1&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token maybe-class-name">List</span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag class-name" style="color:#00009f">UserEntity</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"> userEntities = crudMapper.listUsersByMap(params);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text">    userEntities.forEach(System.out::println);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-jsx codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">src/main/java/com/gitee/pulanos/pangu/showcases/crud/dao/mapper/CrudMapper.java</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-jsx codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * 提示：自定义sql手工映射大部分时候为复杂的多表联合查询的SQL，单表操作都应该统一使用mybatis plus的API</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@</span><span class="token maybe-class-name">Mapper</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">interface</span><span class="token plain"> </span><span class="token class-name">CrudMapper</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token maybe-class-name">List</span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag class-name" style="color:#00009f">UserEntity</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"> listUsersByPage(Page</span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag class-name" style="color:#00009f">UserEntity</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"> page, Map&lt;String, Object&gt; param);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text">    List&lt;Map&lt;String, Object&gt;&gt; listUserMapsByPage(Page&lt;Map&lt;String, Object&gt;&gt; page, String userType);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text">    List</span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag class-name" style="color:#00009f">UserEntity</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"> listUsersByMap(Map&lt;String, Object&gt; param);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-jsx codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">src/main/resources/mapper/CrudMapper.xml</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-jsx codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">mapper</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">namespace</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">com.gitee.pulanos.pangu.showcases.crud.dao.mapper.CrudMapper</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text">&lt;!-- 分页查询 --&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">select</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">id</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">listUsersByPage</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">resultType</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">com.gitee.pulanos.pangu.showcases.crud.dao.entity.UserEntity</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text">    select id,name,age,user_type,gmt_create,gmt_update from user</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">where</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">if</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">test</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">param.userType!=null and param.userType!=</span><span class="token tag attr-value punctuation" style="color:#393A34">&#x27;</span><span class="token tag attr-value punctuation" style="color:#393A34">&#x27;</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text">            user_type = #</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">param</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">userType</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain-text"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">if</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text">    </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">where</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text">    ORDER BY id</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">select</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text">&lt;!-- 分页查询 --&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">select</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">id</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">listUserMapsByPage</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">resultType</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">java.util.Map</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text">    select age, count(id) as userCnt from user</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">where</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">if</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">test</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">userType!=null and userType!=</span><span class="token tag attr-value punctuation" style="color:#393A34">&#x27;</span><span class="token tag attr-value punctuation" style="color:#393A34">&#x27;</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text">            user_type = #</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">userType</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain-text"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">if</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text">    </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">where</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text">    GROUP BY age</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text">    ORDER BY age DESC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">select</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text">&lt;!-- 普通查询 --&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">select</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">id</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">listUsersByMap</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">resultType</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">com.gitee.pulanos.pangu.showcases.crud.dao.entity.UserEntity</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text">    select id,name,age,user_type,gmt_create,gmt_update from user</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">where</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">if</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">test</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">userType!=null and userType!=</span><span class="token tag attr-value punctuation" style="color:#393A34">&#x27;</span><span class="token tag attr-value punctuation" style="color:#393A34">&#x27;</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text">            user_type = #</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">userType</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain-text"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">if</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text">    </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">where</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">select</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">mapper</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="高级特性">高级特性<a class="hash-link" href="#高级特性" title="标题的直接链接">​</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="事务">事务<a class="hash-link" href="#事务" title="标题的直接链接">​</a></h3><p>单一数据源事务，直接使用 Spring 事务相关注解即可（ <code>@EnableTransactionManagement</code>、<code>@Transactional</code> ）。对于分布式事务请参阅 <a href="https://pulanos.gitee.io/pangu-framework/docs/advanced-guide/distributed-transaction" target="_blank" rel="noopener noreferrer">《分布式事务》</a> 章节。</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="逻辑删除">逻辑删除<a class="hash-link" href="#逻辑删除" title="标题的直接链接">​</a></h3><p>盘古框架借助 Mybatis Plus 对逻辑删除提供了非常友好的支持。通过如下简单配置即可实现从物理删除到逻辑删除在 CRUD 上面的无感体验。</p><div class="language-jsx codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-jsx codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 指定逻辑删除的标识字段</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mybatis</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">plus</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">global</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">config</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">db</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">config</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">logic</span><span class="token operator" style="color:#393A34">-</span><span class="token keyword" style="color:#00009f">delete</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">field</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">deleted</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 删除前的缺省值</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mybatis</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">plus</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">global</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">config</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">db</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">config</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">logic</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">not</span><span class="token operator" style="color:#393A34">-</span><span class="token keyword" style="color:#00009f">delete</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">value</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 删除后的值</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mybatis</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">plus</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">global</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">config</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">db</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">config</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">logic</span><span class="token operator" style="color:#393A34">-</span><span class="token keyword" style="color:#00009f">delete</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">value</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">id</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="配置说明">配置说明<a class="hash-link" href="#配置说明" title="标题的直接链接">​</a></h4><ul><li>逻辑删除字段 deleted 建议通过数据库设置默认值 0。</li><li>删除后的值建议不用 1，这会带来某字段需要唯一索引时的尴尬问题。因此建议将删除后的值更新为当前记录的 ID 字段值，如上配置所示。这时如果表中某字段需要建立唯一索引，则可以和 deleted 字段一起创建联合唯一索引。</li><li>查询和更新操作，框架会自动拼接逻辑删除字段作为条件。（AND deleted = 0）</li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="本文相关范例源码">本文相关范例源码<a class="hash-link" href="#本文相关范例源码" title="标题的直接链接">​</a></h2><ul><li><a href="https://gitee.com/pulanos/pangu-framework/tree/master/pangu-examples/pangu-examples-crud" target="_blank" rel="noopener noreferrer">pangu-examples-crud</a>：数据持久化参考范例</li></ul></div><footer class="row docusaurus-mt-lg blogPostFooterDetailsFull_mRVl"><div class="col"><b>标签：</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/blog/tags/服务端开发">服务端开发</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/blog/tags/盘古开发框架">盘古开发框架</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/blog/tags/数据持久化">数据持久化</a></li></ul></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="博文分页导航"><a class="pagination-nav__link pagination-nav__link--prev" href="/blog/blog/rabbitmq-quick-start-and-best-practice"><div class="pagination-nav__sublabel">较新一篇</div><div class="pagination-nav__label">消息队列 RabbitMQ 入门与实践</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/blog/blog/pangu-dev-framework-code-generator"><div class="pagination-nav__sublabel">较旧一篇</div><div class="pagination-nav__label">盘古开发框架代码生成器基本应用</div></a></nav></main><div class="col col--2"><div class="tableOfContents_bqdL thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#安装相关盘古模块" class="table-of-contents__link toc-highlight">安装相关盘古模块</a></li><li><a href="#本地配置" class="table-of-contents__link toc-highlight">本地配置</a></li><li><a href="#生成持久化所需的模版代码" class="table-of-contents__link toc-highlight">生成持久化所需的模版代码</a></li><li><a href="#基本数据持久化操作" class="table-of-contents__link toc-highlight">基本数据持久化操作</a><ul><li><a href="#新增" class="table-of-contents__link toc-highlight">新增</a></li><li><a href="#修改" class="table-of-contents__link toc-highlight">修改</a></li><li><a href="#删除" class="table-of-contents__link toc-highlight">删除</a></li><li><a href="#简单查询" class="table-of-contents__link toc-highlight">简单查询</a></li><li><a href="#分页查询" class="table-of-contents__link toc-highlight">分页查询</a></li><li><a href="#手工编写sql映射" class="table-of-contents__link toc-highlight">手工编写SQL映射</a></li></ul></li><li><a href="#高级特性" class="table-of-contents__link toc-highlight">高级特性</a><ul><li><a href="#事务" class="table-of-contents__link toc-highlight">事务</a></li><li><a href="#逻辑删除" class="table-of-contents__link toc-highlight">逻辑删除</a></li></ul></li><li><a href="#本文相关范例源码" class="table-of-contents__link toc-highlight">本文相关范例源码</a></li></ul></div></div></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 程序员大熊博客网站® &nbsp; <a class="ghostwhite" href="https://beian.miit.gov.cn/" target="_blank">滇ICP备2022001611号-1</a> <br><img src="https://pangu.pulanit.com/img/dashi.gif"></div></div></div></footer></div>
<script src="/blog/assets/js/runtime~main.6306fde2.js"></script>
<script src="/blog/assets/js/main.9ab7ca0e.js"></script>
</body>
</html>